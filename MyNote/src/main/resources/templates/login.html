<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyNote我的筆記-登入</title>
	<!-- 載入本地Tailwind CSS -->
    <link href="/tailwind.min.css" rel="stylesheet">
    <style>
		/* 載入.使用本地字體 */
		@font-face {
		  font-family: 'Inter';
		  src: url('/Inter_18pt-Regular.ttf') format('truetype');
		  font-weight: 400;
		  font-style: normal;
		}
		/* 全域使用字體 */
		body {
		    font-family: 'Inter', sans-serif;
			font-weight: 400;
		}
        /* 隱藏捲軸，保持介面簡潔 */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        /* 確保 textarea 不會被使用者拉伸導致佈局破壞 */
        textarea {
            resize: none;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- 應用程式主容器 -->
    <div id="app-container">
        <!-- 內容將由 JavaScript 渲染 -->
    </div>

    <script>
        // --- 狀態管理 (模擬 React useState) ---
        const DEFAULT_USERNAME = 'LoveJava';
        let usernameInput = DEFAULT_USERNAME;
        const appContainer = document.getElementById('app-container');

        // SVG圖示
		const getIcon = (iconName, size = 20, className = '') => {
		    const icons = {
		        'Squirrel': ` <path d="M15.236 22a3 3 0 0 0-2.2-5"/> <path d="M16 20a3 3 0 0 1 3-3h1a2 2 0 0 0 2-2v-2a4 4 0 0 0-4-4V4"/> <path d="M18 13h.01"/> <path d="M18 6a4 4 0 0 0-4 4 7 7 0 0 0-7 7c0-5 4-5 4-10.5a4.5 4.5 0 1 0-9 0 2.5 2.5 0 0 0 5 0C7 10 3 11 3 17c0 2.8 2.2 5 5 5h10"/>`,
				'ArrowRight': `<line x1="5" x2="19" y1="12" y2="12"/><polyline points="12 5 19 12 12 19"/>`
		    };
		    const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="${size}" height="${size}" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}">${icons[iconName] || ''}</svg>`;
		    
		    return svg;
		};

        // --- 核心邏輯 ---

        //登入呼叫後端
		function handleLogin(event) {
		    event.preventDefault();

		    const account = document.getElementById('username-input').value.trim();
		    const password = document.getElementById('password-input').value;

		    fetch("/login", {
		        method: "POST",
		        headers: { "Content-Type": "application/x-www-form-urlencoded" },
		        body: `account=${encodeURIComponent(account)}&password=${encodeURIComponent(password)}`,
		    })
		    .then(res => res.text())
		    .then(result => {
		        if (result === "ok") {
		            window.location.href = "/notes";
		        } else {
		            alert("帳號或密碼錯誤！");
		        }
		    });
		}


        // 渲染登入頁面
        function renderLogin() {
            appContainer.className = "min-h-screen";
            appContainer.innerHTML = `
                <div class="min-h-screen bg-gray-50 flex flex-col justify-center items-center p-4 font-sans">
                    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-md">
                        <div class="flex justify-center mb-6">
                            <div class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center text-white">
                                ${getIcon('Squirrel', 40)}
                            </div>
                        </div>
                        <h1 class="text-3xl font-bold text-center text-gray-800 mb-2">MyNote</h1>
                        <p class="text-gray-500 text-center mb-8">您的專屬個人筆記空間</p>
                        
                        <form id="login-form" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">帳號</label>
                                <input 
                                    type="text" 
                                    id="username-input"
                                    value="${usernameInput}"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                                    placeholder="請輸入帳號"
                                >
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">密碼</label>
                                <input 
                                    type="password" 
                                    id="password-input"
                                    value="password"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                                    placeholder="請輸入密碼"
                                >
                            </div>
                            <button 
                                type="submit"
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition-colors flex items-center justify-center gap-2 mt-4"
                            >
                                登入 ${getIcon('ArrowRight', 18)}
                            </button>
                        </form>
                    </div>
                </div>
            `;
            
            // 綁定事件監聽器
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('username-input').addEventListener('input', (e) => {
                usernameInput = e.target.value; // 更新狀態變數
            });
        }

        // 初始化應用程式
        window.onload = renderLogin;

    </script>
</body>
</html>